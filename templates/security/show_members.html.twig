{% extends 'base_fluid.html.twig' %}

{% block title %} Team Members {% endblock %}

{% block body %}

    <div class="mt-4">
        {% for label, messages in app.flashes %}
            {% for message in messages %}
                <div class="alert alert-{{ label }}">
                    {{ message }}
                </div>
            {% endfor %}
        {% endfor %}
    </div>

    <div class="d-flex flex-row justify-content-center mt-4">
        {% if is_granted('ROLE_SUPER_ADMIN') or is_granted('ROLE_PROJECT_MANAGER') %}
            <a href="{{ path('add_team_member') }}" class="btn btn-primary">Add new team member</a>
        {% endif %}
        <a href="{{ path('change_own_password') }}" class="btn btn-warning ml-3">Change your password</a>
    </div>

    {% if is_granted('ROLE_SUPER_ADMIN') or is_granted('ROLE_PROJECT_MANAGER') %}
        <div class="card mt-4">
            <div class="card-header bg-dark text-white">
                <b>Total members: {{ allUsers|length }}</b>
            </div>
            <div class="table-responsive" style="max-height: 500px">
                <table class="table table-sm table-dark">
                    <thead class="text-center">
                    <tr style="position: sticky;top: 0;background: #606160;">
                        <th scope="col">Index</th>
                        <th scope="col">Name of member</th>
                        <th scope="col">Email</th>
                        <th scope="col">Role</th>
                        <th scope="col">Delete</th>
                    </tr>
                    </thead>
                    <tbody class="text-center bg-transparent">
                    {% for user in allUsers %}
                        <tr>
                            <td {% if user.implodedRoles == 'ROLE_SUPER_ADMIN' %} style="pointer-events: none" {% endif %}>
                                <a href="{{ path('edit_team_member',{id:user.id}) }}">{{ loop.index }}</a>
                            </td>
                            <td>{{ user.employeeName }}</td>
                            <td>{{ user.email }}</td>
                            <td>{{ user.implodedRoles }}</td>
                            <td><a href="#"><i style="font-size:24px" class="fa">&#xf014;</i></a></td>
                        </tr>
                    {% endfor %}
                    </tbody>
                </table>
            </div>
        </div>
    {% endif %}

{% endblock %}